<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>fplutil: build_all_android</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,700" rel="stylesheet">
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="commonprojectlogo">
    <img alt="Logo" src="fpl_logo_small.png"/>
  </td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">fplutil
   </div>
   <div style="font-size:12px;">
	 An open source project by
     <a href="https://developers.google.com/games/#Tools">FPL</a>.
  </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="fplutil_prerequisites.html"><span>Prerequisites</span></a></li>
      <li><a href="libfplutil_overview.html"><span>libfplutil</span></a></li>
      <li><a href="android_ndk_perf.html"><span>android_ndk_perf.py</span></a></li>
      <li><a href="build_all_android.html"><span>build_all_android.py</span></a></li>
      <li><a href="buildutil_overview.html"><span>buildutil</span></a></li>
      <li><a href="md_readme.html#fplutil_readme"><span>readme</span></a></li>
      <li><a href="contributing.html"><span>contributing</span></a></li>
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('build_all_android.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">build_all_android </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="build_all_android.html">build_all_android</a> is an all-in-one build script that allows you to build, install and run native (C/C++) Android apps from the command line. This is ideal for build automation, but can also be in a developerâ€™s compile/run loop.</p>
<p>In order to use this tool, all <a class="el" href="fplutil_prerequisites.html">prerequisites</a> should be installed.</p>
<h1><a class="anchor" id="build_all_android_build"></a>
Building Applications</h1>
<p>By default <a class="el" href="build_all_android.html">build_all_android</a> will build all Android projects under the current working directory. For example, from the command line, the following will change into the <a href="index.html">fplutil</a> directory and build all Android projects:</p>
<div class="fragment"><div class="line">cd fplutil</div>
<div class="line">./bin/build_all_android -E dependencies</div>
</div><!-- fragment --><p>The application will place the build artifacts in the following locations:</p>
<ul>
<li>APKs in <code>fplutil/apks</code></li>
<li>Shared (.so) and Static (.a) libraries in <code>fplutil/libs</code>.</li>
</ul>
<p>The following files are produced when building all Android targets in <a href="index.html">fplutil</a>:</p>
<div class="fragment"><div class="line">apks/example-release-<span class="keywordtype">unsigned</span>.apk</div>
<div class="line">apks/tests-release-<span class="keywordtype">unsigned</span>.apk</div>
</div><!-- fragment --><h1><a class="anchor" id="build_all_android_sign"></a>
Signing Applications</h1>
<p>In order to install a release APK on a device it must be signed. By default <a class="el" href="build_all_android.html">build_all_android</a> build but not sign release APKs. The <code>-S</code> or <code>--sign_apk</code> flag will enable signing of APKs.</p>
<p>For example, the following will build and sign all APKs with a temporary key:</p>
<div class="fragment"><div class="line">cd fplutil</div>
<div class="line">./bin/build_all_android -E dependencies -S</div>
</div><!-- fragment --><p>In a similar fashion to unsigned APKs, signed APKs are placed in the apks directory. Signed APK names do not end in <code>-unsigned.apk</code>.</p>
<div class="fragment"><div class="line">apks/example-release-<span class="keywordtype">unsigned</span>.apk</div>
<div class="line">apks/example.apk</div>
<div class="line">apks/tests-release-<span class="keywordtype">unsigned</span>.apk</div>
<div class="line">apks/tests.apk</div>
</div><!-- fragment --><h2><a class="anchor" id="build_all_android_sign_key"></a>
Signing with Keys</h2>
<p>The method described above generates a temporary key, which is used to sign the application. Using a temporary key is ok when debugging but should not be used when distributing your application to consumers as the application's certificate is used to validate it's origin and allow the application to be safely upgraded in future.</p>
<p>Firstly, a key needs to be generated using <a href="http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html">keytool</a> which will be used to sign the application in future. The following generates a certificate referenced by the name <code>my_alias</code> in the keystore file <code>my-release-key.keystore</code> using the <code>RSA</code> algorithm with a lifetime of around 27.5 years (<code>10000</code> days).</p>
<div class="fragment"><div class="line">$ keytool -genkey -v -keystore my-release-key.keystore \</div>
<div class="line">          -alias my_alias -keyalg RSA -keysize 2048 -validity 10000</div>
</div><!-- fragment --><p><a href="http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html">keytool</a> will prompt for additional information required to generate the key and a password which is used to access the keystore file in future.</p>
<p>After saving the password supplied to <a href="http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html">keytool</a> in a file (e.g <code>mysecretpassword_file.txt</code>), applications can be built and signed with <a class="el" href="build_all_android.html">build_all_android</a>:</p>
<div class="fragment"><div class="line">cd fplutil/examples/libfplutil_example</div>
<div class="line">../../bin/build_all_android -S -k my-release-key.keystore \</div>
<div class="line">                            -K my_alias</div>
<div class="line">                            -P mysecretpassword_file.txt</div>
</div><!-- fragment --><p>The "Signing Your App Manually" section on <a href="http://developer.android.com/tools/publishing/app-signing.html">Signing Your Applications</a> describes in detail how to generate a private key using <a href="http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html">keytool</a> and sign an application directly using jarsigner.</p>
<p>It is also possible to sign using a private / public key pair (pk8 / pem) using the <code>--apk_keypk8</code> and <code>--apk_keypem</code> arguments of <a class="el" href="build_all_android.html">build_all_android</a>. For information on how to generate pk8 / pem files see <a href="http://www.londatiga.net/it/how-to-sign-apk-zip-files/">How to Sign APK Zip Files</a>.</p>
<h1><a class="anchor" id="build_all_android_install"></a>
Installing Applications</h1>
<p>Using the <code>-i</code> or <code>--apk_install</code> flag, <a class="el" href="build_all_android.html">build_all_android</a> can install applications to one or more devices attached to a workstation.</p>
<p>For example, the following will build all Android applications in <a href="index.html">fplutil</a>, sign the APKs and install them to an attached device:</p>
<div class="fragment"><div class="line">cd fplutil</div>
<div class="line">./bin/build_all_android -E dependencies -S -i</div>
</div><!-- fragment --><h1><a class="anchor" id="build_all_android_run"></a>
Running Applications</h1>
<p><a class="el" href="build_all_android.html">build_all_android</a> will run applications on an attached Android device when the <code>-r</code> or <code>--apk_run</code> flag is specified.</p>
<p>For example, the following will build all Android applications in <a href="index.html">fplutil</a>, sign the APKs, install them to an attached device and then execute them in sequence:</p>
<div class="fragment"><div class="line">cd fplutil</div>
<div class="line">./bin/build_all_android -E dependencies -S -i -r</div>
</div><!-- fragment --><h1><a class="anchor" id="build_all_android_build_config"></a>
Build Configuration</h1>
<p>By default <a class="el" href="build_all_android.html">build_all_android</a> will build all applications in <code>release</code> mode. It's possible to select the <code>debug</code> with the <code>-T</code> or <code>--ant_target</code> flag.</p>
<p>For example, the following will build all <a href="index.html">fplutil</a> applications in debug mode with no native (C/C++) symbols:</p>
<div class="fragment"><div class="line">cd fplutil</div>
<div class="line">./bin/build_all_android -E dependencies -T debug</div>
</div><!-- fragment --><p>In order to perform symbolic debugging of native (C/C++) components with <code>ndk-gdb</code> <code>NDK_DEBUG=1</code> must be passed to <code>ndk-build</code>. Arguments are passed to <code>ndk-build</code> using the <code>-f</code> or <code>--make_flags</code> flag.</p>
<p>For example:</p>
<div class="fragment"><div class="line">cd fplutil</div>
<div class="line">./bin/build_all_android -E dependencies -T debug -f NDK_DEBUG=1</div>
</div><!-- fragment --><p>To force optimization in debug mode, set <code>NDK_DEBUG=0</code>.</p>
<div class="fragment"><div class="line">cd fplutil</div>
<div class="line">./bin/build_all_android -E dependencies -T debug -f NDK_DEBUG=0</div>
</div><!-- fragment --><h1><a class="anchor" id="build_all_android_clean"></a>
Cleaning Build Artifacts</h1>
<p>Build artifacts can be cleaned using the <code>-c</code> or <code>--clean</code> flag. For example:</p>
<div class="fragment"><div class="line">./bin/build_all_android -E dependencies -c</div>
</div><!-- fragment --><h1><a class="anchor" id="build_all_android_multiple_devices"></a>
Working with Multiple Devices</h1>
<p>By default, <a class="el" href="build_all_android.html">build_all_android</a> will only install or run applications on one connected device. It's possible to select the set of devices using <code>-d</code> followed by a list of device serial numbers or <code>@</code> which selects all devices attached to the workstation.</p>
<p>For example, the following will build all Android applications in <a href="index.html">fplutil</a>, sign them, install and run them on all attached devices:</p>
<div class="fragment"><div class="line">cd fplutil</div>
<div class="line">./bin/build_all_android -E dependencies -S -i -r -d @</div>
</div><!-- fragment --><p><br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-49880327-7', 'google.github.io');
ga('send', 'pageview');
</script>
</body>
</html>
