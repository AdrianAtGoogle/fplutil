<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>fplutil: Using libfplutil_print</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,700" rel="stylesheet">
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">fplutil
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="fplutil_prerequisites.html"><span>Prerequisites</span></a></li>
      <li><a href="libfplutil_overview.html"><span>libfplutil</span></a></li>
      <li><a href="android_ndk_perf.html"><span>android_ndk_perf.py</span></a></li>
      <li><a href="build_all_android.html"><span>build_all_android.py</span></a></li>
      <li><a href="buildutil_overview.html"><span>buildutil</span></a></li>
      <li><a href="md_readme.html#fplutil_readme"><span>readme</span></a></li>
      <li><a href="contributing.html"><span>contributing</span></a></li>
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('libfplutil_print.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Using libfplutil_print </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>libfplutil_print</code> implements a set of wrappers for functions that write to the standard output stream. This enables applications that write to the terminal using printf to have their output redirected to the Android log.</p>
<p>Using both <code>libfplutil_main</code> and <code>libfplutil_print</code> makes it possible to compile and run non-interactive command line applications on Android devices.</p>
<p>It's possible to use <code>libfplutil_print</code> without <code>libfplutil_main</code> in conjunction with <a href="http://developer.android.com/reference/android/app/NativeActivity.html">NativeActivity</a> by implementing an <code>android_main</code> entry point or using <code>printf</code> in libraries that are called from Java modules. However, the typical use case is to use <code>libfplutil_print</code> in conjunction with <code>libfplutil_main</code> so that C/C++ applications can easily be cross compiled to multiple platforms including Android.</p>
<p>For example, the canonical C "Hello World" application will compile and run on Android simply by linking with both <code>libfplutil_print</code> and <code>libfplutil_main</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="main_8h.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  printf(<span class="stringliteral">&quot;Hello World\n&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The above application, when compiled and linked against <code>libfplutil_print</code> and <code>libfplutil_main</code> (see <a class="el" href="libfplutil_linking.html">Linking</a>) will print "Hello World" to the Android log which can be viewed using <a href="http://developer.android.com/tools/help/adb.html">adb</a>'s <a href="http://developer.android.com/tools/help/logcat.html">logcat</a> command.</p>
<h1><a class="anchor" id="libfplutil_print_tag"></a>
Customizing the Log Tag</h1>
<p>By default, the tag used to annontate log messages is "main", this can be modified using the <code><a class="el" href="print_8h.html#adda7aff401767be3d848652a1bbd0114">SetAndroidLogWrapperTag()</a></code> function. For example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="print_8h.html">fplutil/print.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="main_8h.html">fplutil/main.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="main_8h.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="print_8h.html#adda7aff401767be3d848652a1bbd0114">SetAndroidLogWrapperTag</a>(<span class="stringliteral">&quot;my_application&quot;</span>);</div>
<div class="line">  printf(<span class="stringliteral">&quot;Print to the log from printf\n&quot;</span>);</div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Print to the log from a stream&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Prints the following to Android's log: </p>
<pre class="fragment"> Print to the log from printf
 Print to the log from a stream
</pre><p>All log messages from the application will be prefixed with the tag, "my_application" so they can optionally extracted from <a href="http://developer.android.com/tools/help/adb.html">adb</a> <a href="http://developer.android.com/tools/help/logcat.html">logcat</a> using</p>
<div class="fragment"><div class="line">adb logcat -s <span class="stringliteral">&quot;my_application&quot;</span></div>
</div><!-- fragment --><p>In addition to changing the tag, it's possible to modify the log priority <code><a class="el" href="print_8h.html#a48bcb4cf5ef6ee9f01763abcfc595bda">SetAndroidLogWrapperPriority()</a></code>.</p>
<h1><a class="anchor" id="libfplutil_print_buffering"></a>
Configuring Buffering</h1>
<p>Each Android log message is terminated with a newline, so in order to simulate printf behavior where newlines are explicit, <code>libfplutil_print</code> will buffer messages up to 256 bytes before writing a line to the log. The size of this buffer can be modified using <code><a class="el" href="print_8h.html#a00d24d2e230c5cbd2e2a0da7d79d082e">SetAndroidLogWrapperBufferSize()</a></code>.</p>
<p>For example, after increasing the buffer size to 1KB, the following will print a line longer than 256 bytes to a single log message:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="print_8h.html">fplutil/print.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="main_8h.html">fplutil/main.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="main_8h.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="print_8h.html#a00d24d2e230c5cbd2e2a0da7d79d082e">SetAndroidLogWrapperBufferSize</a>(1024);</div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; i &lt; 256; i++) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;*&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  printf(<span class="stringliteral">&quot;A long line\n&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="libfplutil_print_redirection"></a>
Redirecting Output</h1>
<p><code>libfplutil_print</code> captures all output to the standard output stream and by default sends it to the Android log. Applications can capture data sent to the standard output stream and perform further processing before sending it to the log. This can be useful when logging to files or annotating log messages with custom logic.</p>
<p>For example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="print_8h.html">fplutil/print.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="main_8h.html">fplutil/main.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> CaptureLog(<span class="keywordtype">int</span> priority, <span class="keyword">const</span> <span class="keywordtype">char</span> *tag, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,</div>
<div class="line">               va_list list) {</div>
<div class="line">  <span class="comment">// Do something with the message.</span></div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="main_8h.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="print_8h.html#abb85d2a7b709f3e4457cd67541b0266f">SetAndroidStdioOutputFunction</a>(CaptureLog);</div>
<div class="line">  printf(<span class="stringliteral">&quot;A message to capture\n&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p><br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-49880327-7', 'google.github.io');
ga('send', 'pageview');
</script>
</body>
</html>
